{-# LANGUAGE PatternSynonyms #-}
{-# LANGUAGE TypeApplications #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE FlexibleContexts #-}

-- | Manages accessories.
--
-- Generated bindings for @ASAccessorySession@.
module ObjC.AccessorySetupKit.ASAccessorySession
  ( ASAccessorySession
  , IsASAccessorySession(..)
  , activateWithQueue_eventHandler
  , invalidate
  , showPickerWithCompletionHandler
  , showPickerForDisplayItems_completionHandler
  , finishAuthorization_settings_completionHandler
  , failAuthorization_completionHandler
  , removeAccessory_completionHandler
  , renameAccessory_options_completionHandler
  , updateAuthorization_descriptor_completionHandler
  , updatePickerShowingDiscoveredDisplayItems_completionHandler
  , finishPickerDiscovery
  , accessories
  , pickerDisplaySettings
  , setPickerDisplaySettings
  , activateWithQueue_eventHandlerSelector
  , invalidateSelector
  , showPickerWithCompletionHandlerSelector
  , showPickerForDisplayItems_completionHandlerSelector
  , finishAuthorization_settings_completionHandlerSelector
  , failAuthorization_completionHandlerSelector
  , removeAccessory_completionHandlerSelector
  , renameAccessory_options_completionHandlerSelector
  , updateAuthorization_descriptor_completionHandlerSelector
  , updatePickerShowingDiscoveredDisplayItems_completionHandlerSelector
  , finishPickerDiscoverySelector
  , accessoriesSelector
  , pickerDisplaySettingsSelector
  , setPickerDisplaySettingsSelector

  -- * Enum types
  , ASAccessoryRenameOptions(ASAccessoryRenameOptions)
  , pattern ASAccessoryRenameSSID

  ) where

import Foreign.Ptr (Ptr, nullPtr, castPtr)
import Foreign.LibFFI
import Foreign.C.Types
import Data.Int (Int8, Int16)
import Data.Word (Word16)
import Data.Coerce (coerce)

import ObjC.Runtime.Types
import ObjC.Runtime.MsgSend (sendMsg, sendClassMsg)
import ObjC.Runtime.Selector (mkSelector)
import ObjC.Runtime.Class (getRequiredClass)

import ObjC.AccessorySetupKit.Internal.Classes
import ObjC.AccessorySetupKit.Internal.Enums
import ObjC.Foundation.Internal.Classes

-- | Activate the session and start delivering events to an event handler. - Parameters:   - queue: The dispatch the session uses to deliver events to @eventHandler@.   - eventHandler: A closure or block that receives events generated by the session. Each callback to the event handler provides an ``ASAccessoryEvent`` as a parameter, and expects no return value.
--
-- ObjC selector: @- activateWithQueue:eventHandler:@
activateWithQueue_eventHandler :: (IsASAccessorySession asAccessorySession, IsNSObject queue) => asAccessorySession -> queue -> Ptr () -> IO ()
activateWithQueue_eventHandler asAccessorySession  queue eventHandler =
  withObjCPtr queue $ \raw_queue ->
      sendMsg asAccessorySession (mkSelector "activateWithQueue:eventHandler:") retVoid [argPtr (castPtr raw_queue :: Ptr ()), argPtr (castPtr eventHandler :: Ptr ())]

-- | Invalidate the session by stopping any operations.
--
-- This call breaks any retain cycles. The session is unusable after calling @invalidate@.
--
-- ObjC selector: @- invalidate@
invalidate :: IsASAccessorySession asAccessorySession => asAccessorySession -> IO ()
invalidate asAccessorySession  =
    sendMsg asAccessorySession (mkSelector "invalidate") retVoid []

-- | Present a picker that shows accessories managed by a Device Discovery Extension in your app.
--
-- Use this method when your app includes a <doc://com.apple.documentation/documentation/devicediscoveryextension> for its supported accessories. If your app doesn't use DDE, call ``showPickerForDisplayItems:completionHandler:`` with an array of ``ASPickerDisplayItem-c.class`` instances instead.
--
-- The session's event handler receives events when this picker displays and dismisses, as well as when the person using the app picks an accessory.
--
-- - Parameters:   - completionHandler: A block or closure that the picker calls when it completes the operation. The completion handler receives an <doc://com.apple.documentation/documentation/Foundation/NSError> instance if the picker encounters an error.
--
-- ObjC selector: @- showPickerWithCompletionHandler:@
showPickerWithCompletionHandler :: IsASAccessorySession asAccessorySession => asAccessorySession -> Ptr () -> IO ()
showPickerWithCompletionHandler asAccessorySession  completionHandler =
    sendMsg asAccessorySession (mkSelector "showPickerWithCompletionHandler:") retVoid [argPtr (castPtr completionHandler :: Ptr ())]

-- | Present a picker that shows discovered accessories matching an array of display items.
--
-- The session's event handler receives events when this picker displays and dismisses, as well as when the person using the app picks an accessory.
--
-- To migrate previously-configured accessories to AccessorySetupKit, add instances of ``ASMigrationDisplayItem`` to the @displayItems@ array. - Parameters:   - displayItems: An array of ``ASPickerDisplayItem`` instances describing accessories your app can set up. The picker displays only discovered accessories that match the properties of items in this array.   - completionHandler: A block or closure that the picker calls when it completes the operation. The completion handler receives an <doc://com.apple.documentation/documentation/Foundation/NSError> instance if the picker encounters an error.
--
-- ObjC selector: @- showPickerForDisplayItems:completionHandler:@
showPickerForDisplayItems_completionHandler :: (IsASAccessorySession asAccessorySession, IsNSArray displayItems) => asAccessorySession -> displayItems -> Ptr () -> IO ()
showPickerForDisplayItems_completionHandler asAccessorySession  displayItems completionHandler =
  withObjCPtr displayItems $ \raw_displayItems ->
      sendMsg asAccessorySession (mkSelector "showPickerForDisplayItems:completionHandler:") retVoid [argPtr (castPtr raw_displayItems :: Ptr ()), argPtr (castPtr completionHandler :: Ptr ())]

-- | Finish authorization of a partially-setup accessory.
--
-- Use this method in scenarios where an accessory has multiple wireless interfaces. For example, when an accessory has both Bluetooth and Wi-Fi, and your descriptor may only provides an SSID prefix. In this case, the Bluetooth interface onboards first and your app needs to then finish authorization with the full SSID.
--
-- ObjC selector: @- finishAuthorization:settings:completionHandler:@
finishAuthorization_settings_completionHandler :: (IsASAccessorySession asAccessorySession, IsASAccessory accessory, IsASAccessorySettings settings) => asAccessorySession -> accessory -> settings -> Ptr () -> IO ()
finishAuthorization_settings_completionHandler asAccessorySession  accessory settings completionHandler =
  withObjCPtr accessory $ \raw_accessory ->
    withObjCPtr settings $ \raw_settings ->
        sendMsg asAccessorySession (mkSelector "finishAuthorization:settings:completionHandler:") retVoid [argPtr (castPtr raw_accessory :: Ptr ()), argPtr (castPtr raw_settings :: Ptr ()), argPtr (castPtr completionHandler :: Ptr ())]

-- | End authorization of a partially-configured accessory as a failure.
--
-- ObjC selector: @- failAuthorization:completionHandler:@
failAuthorization_completionHandler :: (IsASAccessorySession asAccessorySession, IsASAccessory accessory) => asAccessorySession -> accessory -> Ptr () -> IO ()
failAuthorization_completionHandler asAccessorySession  accessory completionHandler =
  withObjCPtr accessory $ \raw_accessory ->
      sendMsg asAccessorySession (mkSelector "failAuthorization:completionHandler:") retVoid [argPtr (castPtr raw_accessory :: Ptr ()), argPtr (castPtr completionHandler :: Ptr ())]

-- | Removes an accessory.
--
-- - Parameters:   - accessory: The accessory to remove.   - completionHandler: A block or closure that executes after the remove operation completes. The completion handler receives an <doc://com.apple.documentation/documentation/Foundation/NSError> instance if the remove operation encounters an error.
--
-- ObjC selector: @- removeAccessory:completionHandler:@
removeAccessory_completionHandler :: (IsASAccessorySession asAccessorySession, IsASAccessory accessory) => asAccessorySession -> accessory -> Ptr () -> IO ()
removeAccessory_completionHandler asAccessorySession  accessory completionHandler =
  withObjCPtr accessory $ \raw_accessory ->
      sendMsg asAccessorySession (mkSelector "removeAccessory:completionHandler:") retVoid [argPtr (castPtr raw_accessory :: Ptr ()), argPtr (castPtr completionHandler :: Ptr ())]

-- | Displays a view to rename an accessory.
--
-- To rename a Wi-Fi SSID with this method, use the option ``ASAccessory/RenameOptions/ssid``.
--
-- - Parameters:   - accessory: The accessory to rename.   - renameOptions: Options that affect the behavior of the rename operation.   - completionHandler: A block or closure that executes after the rename operation completes. The completion handler receives an <doc://com.apple.documentation/documentation/Foundation/NSError> instance if the rename operation encounters an error.
--
-- ObjC selector: @- renameAccessory:options:completionHandler:@
renameAccessory_options_completionHandler :: (IsASAccessorySession asAccessorySession, IsASAccessory accessory) => asAccessorySession -> accessory -> ASAccessoryRenameOptions -> Ptr () -> IO ()
renameAccessory_options_completionHandler asAccessorySession  accessory renameOptions completionHandler =
  withObjCPtr accessory $ \raw_accessory ->
      sendMsg asAccessorySession (mkSelector "renameAccessory:options:completionHandler:") retVoid [argPtr (castPtr raw_accessory :: Ptr ()), argCULong (coerce renameOptions), argPtr (castPtr completionHandler :: Ptr ())]

-- | Displays a view to upgrade an accessory with additional technology permissions.
--
-- Call this method to upgrade previously-added SSID-based accessories to use WiFi Aware.
--
-- - Parameters:   - accessory: The accessory to update.   - descriptor: An updated descriptor that the picker uses to add new technology authorization for the provided accessory.   - completionHandler: A block or closure that executes after the picker is shown. The completion handler receives an <doc://com.apple.documentation/documentation/Foundation/NSError> instance if the upgrade operation encounters an error. In Swift, you can omit the completion handler by calling the method asynchronously and catching any error thrown by the method.
--
-- ObjC selector: @- updateAuthorization:descriptor:completionHandler:@
updateAuthorization_descriptor_completionHandler :: (IsASAccessorySession asAccessorySession, IsASAccessory accessory, IsASDiscoveryDescriptor descriptor) => asAccessorySession -> accessory -> descriptor -> Ptr () -> IO ()
updateAuthorization_descriptor_completionHandler asAccessorySession  accessory descriptor completionHandler =
  withObjCPtr accessory $ \raw_accessory ->
    withObjCPtr descriptor $ \raw_descriptor ->
        sendMsg asAccessorySession (mkSelector "updateAuthorization:descriptor:completionHandler:") retVoid [argPtr (castPtr raw_accessory :: Ptr ()), argPtr (castPtr raw_descriptor :: Ptr ()), argPtr (castPtr completionHandler :: Ptr ())]

-- | Updates the picker with app-filtered accessories.
--
-- You use this method when your picker uses the ``ASPickerDisplaySettings/Options/filterDiscoveryResults`` option to enable manual filtering of discovered accessories. After creating customized ``ASDiscoveredDisplayItem`` instances for included accessories, call this method to update the picker to show your app-filtered accessories with updated assets.
--
-- - Parameters:   - displayItems: The app-filtered accessories to show in the picker.   - completionHandler: A block or closure that executes after the updatePicker operation completes. The completion handler receives an <doc://com.apple.documentation/documentation/Foundation/NSError> instance if the operation encounters an error.
--
-- ObjC selector: @- updatePickerShowingDiscoveredDisplayItems:completionHandler:@
updatePickerShowingDiscoveredDisplayItems_completionHandler :: (IsASAccessorySession asAccessorySession, IsNSArray displayItems) => asAccessorySession -> displayItems -> Ptr () -> IO ()
updatePickerShowingDiscoveredDisplayItems_completionHandler asAccessorySession  displayItems completionHandler =
  withObjCPtr displayItems $ \raw_displayItems ->
      sendMsg asAccessorySession (mkSelector "updatePickerShowingDiscoveredDisplayItems:completionHandler:") retVoid [argPtr (castPtr raw_displayItems :: Ptr ()), argPtr (castPtr completionHandler :: Ptr ())]

-- | Finish the discovery session in the picker and show a timeout error.
--
-- Use this method if you previously set the picker display setting ``ASPickerDisplaySettings/discoveryTimeout`` to ``ASPickerDisplaySettings/DiscoveryTimeout/unbounded`` in order to perform manual filtering of discovered accessories. Calling this method finishes the discovery session in the picker and shows a timeout error if the session didn't find any desired accessories.
--
-- Calling this method after updating the picker with discovered accessories has no effect.
--
-- - Parameters:   - completionHandler: A block or closure that executes after this operation completes. The completion handler receives an <doc://com.apple.documentation/documentation/Foundation/NSError> instance if the operation encounters an error.
--
-- ObjC selector: @- finishPickerDiscovery:@
finishPickerDiscovery :: IsASAccessorySession asAccessorySession => asAccessorySession -> Ptr () -> IO ()
finishPickerDiscovery asAccessorySession  completionHandler =
    sendMsg asAccessorySession (mkSelector "finishPickerDiscovery:") retVoid [argPtr (castPtr completionHandler :: Ptr ())]

-- | An array of previously-selected accessories for this application.
--
-- To monitor for changes in this list, use your event handler to watch for the events ``ASAccessoryEventType/accessoryAdded``, ``ASAccessoryEventType/accessoryChanged``, and ``ASAccessoryEventType/accessoryRemoved``.
--
-- ObjC selector: @- accessories@
accessories :: IsASAccessorySession asAccessorySession => asAccessorySession -> IO (Id NSArray)
accessories asAccessorySession  =
    sendMsg asAccessorySession (mkSelector "accessories") (retPtr retVoid) [] >>= retainedObject . castPtr

-- | Settings that affect the display of the accessory picker.
--
-- Use this property to configure settings like the picker timeout.
--
-- ObjC selector: @- pickerDisplaySettings@
pickerDisplaySettings :: IsASAccessorySession asAccessorySession => asAccessorySession -> IO (Id ASPickerDisplaySettings)
pickerDisplaySettings asAccessorySession  =
    sendMsg asAccessorySession (mkSelector "pickerDisplaySettings") (retPtr retVoid) [] >>= retainedObject . castPtr

-- | Settings that affect the display of the accessory picker.
--
-- Use this property to configure settings like the picker timeout.
--
-- ObjC selector: @- setPickerDisplaySettings:@
setPickerDisplaySettings :: (IsASAccessorySession asAccessorySession, IsASPickerDisplaySettings value) => asAccessorySession -> value -> IO ()
setPickerDisplaySettings asAccessorySession  value =
  withObjCPtr value $ \raw_value ->
      sendMsg asAccessorySession (mkSelector "setPickerDisplaySettings:") retVoid [argPtr (castPtr raw_value :: Ptr ())]

-- ---------------------------------------------------------------------------
-- Selectors
-- ---------------------------------------------------------------------------

-- | @Selector@ for @activateWithQueue:eventHandler:@
activateWithQueue_eventHandlerSelector :: Selector
activateWithQueue_eventHandlerSelector = mkSelector "activateWithQueue:eventHandler:"

-- | @Selector@ for @invalidate@
invalidateSelector :: Selector
invalidateSelector = mkSelector "invalidate"

-- | @Selector@ for @showPickerWithCompletionHandler:@
showPickerWithCompletionHandlerSelector :: Selector
showPickerWithCompletionHandlerSelector = mkSelector "showPickerWithCompletionHandler:"

-- | @Selector@ for @showPickerForDisplayItems:completionHandler:@
showPickerForDisplayItems_completionHandlerSelector :: Selector
showPickerForDisplayItems_completionHandlerSelector = mkSelector "showPickerForDisplayItems:completionHandler:"

-- | @Selector@ for @finishAuthorization:settings:completionHandler:@
finishAuthorization_settings_completionHandlerSelector :: Selector
finishAuthorization_settings_completionHandlerSelector = mkSelector "finishAuthorization:settings:completionHandler:"

-- | @Selector@ for @failAuthorization:completionHandler:@
failAuthorization_completionHandlerSelector :: Selector
failAuthorization_completionHandlerSelector = mkSelector "failAuthorization:completionHandler:"

-- | @Selector@ for @removeAccessory:completionHandler:@
removeAccessory_completionHandlerSelector :: Selector
removeAccessory_completionHandlerSelector = mkSelector "removeAccessory:completionHandler:"

-- | @Selector@ for @renameAccessory:options:completionHandler:@
renameAccessory_options_completionHandlerSelector :: Selector
renameAccessory_options_completionHandlerSelector = mkSelector "renameAccessory:options:completionHandler:"

-- | @Selector@ for @updateAuthorization:descriptor:completionHandler:@
updateAuthorization_descriptor_completionHandlerSelector :: Selector
updateAuthorization_descriptor_completionHandlerSelector = mkSelector "updateAuthorization:descriptor:completionHandler:"

-- | @Selector@ for @updatePickerShowingDiscoveredDisplayItems:completionHandler:@
updatePickerShowingDiscoveredDisplayItems_completionHandlerSelector :: Selector
updatePickerShowingDiscoveredDisplayItems_completionHandlerSelector = mkSelector "updatePickerShowingDiscoveredDisplayItems:completionHandler:"

-- | @Selector@ for @finishPickerDiscovery:@
finishPickerDiscoverySelector :: Selector
finishPickerDiscoverySelector = mkSelector "finishPickerDiscovery:"

-- | @Selector@ for @accessories@
accessoriesSelector :: Selector
accessoriesSelector = mkSelector "accessories"

-- | @Selector@ for @pickerDisplaySettings@
pickerDisplaySettingsSelector :: Selector
pickerDisplaySettingsSelector = mkSelector "pickerDisplaySettings"

-- | @Selector@ for @setPickerDisplaySettings:@
setPickerDisplaySettingsSelector :: Selector
setPickerDisplaySettingsSelector = mkSelector "setPickerDisplaySettings:"

