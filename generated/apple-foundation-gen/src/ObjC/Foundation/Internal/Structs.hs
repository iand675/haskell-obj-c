{-# LANGUAGE RecordWildCards #-}
{-# LANGUAGE TypeFamilies #-}

-- | Struct types for this framework.
--
-- Generated by objc-codegen. Do not edit.
module ObjC.Foundation.Internal.Structs where

import Foreign.Ptr (Ptr, FunPtr)
import Foreign.Storable (Storable(..))
import Foreign.C.Types
import Foreign.LibFFI.Base (Arg, RetType, mkStorableArg, mkStorableRetType, newStructCType)
import Foreign.LibFFI.FFITypes
import Foreign.LibFFI.Internal (CType)
import System.IO.Unsafe (unsafePerformIO)
import ObjC.Runtime.Message (ObjCArgument(..), ObjCReturn(..), MsgSendVariant(..))

data NSEdgeInsets = NSEdgeInsets
  { nsEdgeInsetsTop :: !CDouble
  , nsEdgeInsetsLeft :: !CDouble
  , nsEdgeInsetsBottom :: !CDouble
  , nsEdgeInsetsRight :: !CDouble
  } deriving (Eq, Show)

instance Storable NSEdgeInsets where
  sizeOf    _ = 32
  alignment _ = 8
  peek p = NSEdgeInsets <$> peekByteOff p 0
    <*> peekByteOff p 8
    <*> peekByteOff p 16
    <*> peekByteOff p 24
  poke p (NSEdgeInsets {..}) = do
    pokeByteOff p 0 nsEdgeInsetsTop
    pokeByteOff p 8 nsEdgeInsetsLeft
    pokeByteOff p 16 nsEdgeInsetsBottom
    pokeByteOff p 24 nsEdgeInsetsRight

{-# NOINLINE nsEdgeInsetsStructType #-}
nsEdgeInsetsStructType :: Ptr CType
nsEdgeInsetsStructType = unsafePerformIO $ fst <$> newStructCType [ffi_type_double, ffi_type_double, ffi_type_double, ffi_type_double]

argNSEdgeInsets :: NSEdgeInsets -> Arg
argNSEdgeInsets = mkStorableArg nsEdgeInsetsStructType

retNSEdgeInsets :: RetType NSEdgeInsets
retNSEdgeInsets = mkStorableRetType nsEdgeInsetsStructType

instance ObjCArgument NSEdgeInsets where
  withObjCArg x k = k (argNSEdgeInsets x)

instance ObjCReturn NSEdgeInsets where
  type RawReturn NSEdgeInsets = NSEdgeInsets
  objcRetType = retNSEdgeInsets
  msgSendVariant = MsgSendStret
  fromRetained = pure
  fromOwned = pure

data NSPoint = NSPoint
  { nsPointX :: !CDouble
  , nsPointY :: !CDouble
  } deriving (Eq, Show)

instance Storable NSPoint where
  sizeOf    _ = 16
  alignment _ = 8
  peek p = NSPoint <$> peekByteOff p 0
    <*> peekByteOff p 8
  poke p (NSPoint {..}) = do
    pokeByteOff p 0 nsPointX
    pokeByteOff p 8 nsPointY

{-# NOINLINE nsPointStructType #-}
nsPointStructType :: Ptr CType
nsPointStructType = unsafePerformIO $ fst <$> newStructCType [ffi_type_double, ffi_type_double]

argNSPoint :: NSPoint -> Arg
argNSPoint = mkStorableArg nsPointStructType

retNSPoint :: RetType NSPoint
retNSPoint = mkStorableRetType nsPointStructType

instance ObjCArgument NSPoint where
  withObjCArg x k = k (argNSPoint x)

instance ObjCReturn NSPoint where
  type RawReturn NSPoint = NSPoint
  objcRetType = retNSPoint
  msgSendVariant = MsgSendStret
  fromRetained = pure
  fromOwned = pure

data NSRange = NSRange
  { nsRangeLocation :: !CULong
  , nsRangeLength :: !CULong
  } deriving (Eq, Show)

instance Storable NSRange where
  sizeOf    _ = 16
  alignment _ = 8
  peek p = NSRange <$> peekByteOff p 0
    <*> peekByteOff p 8
  poke p (NSRange {..}) = do
    pokeByteOff p 0 nsRangeLocation
    pokeByteOff p 8 nsRangeLength

{-# NOINLINE nsRangeStructType #-}
nsRangeStructType :: Ptr CType
nsRangeStructType = unsafePerformIO $ fst <$> newStructCType [ffi_type_ulong, ffi_type_ulong]

argNSRange :: NSRange -> Arg
argNSRange = mkStorableArg nsRangeStructType

retNSRange :: RetType NSRange
retNSRange = mkStorableRetType nsRangeStructType

instance ObjCArgument NSRange where
  withObjCArg x k = k (argNSRange x)

instance ObjCReturn NSRange where
  type RawReturn NSRange = NSRange
  objcRetType = retNSRange
  msgSendVariant = MsgSendStret
  fromRetained = pure
  fromOwned = pure

data NSSize = NSSize
  { nsSizeWidth :: !CDouble
  , nsSizeHeight :: !CDouble
  } deriving (Eq, Show)

instance Storable NSSize where
  sizeOf    _ = 16
  alignment _ = 8
  peek p = NSSize <$> peekByteOff p 0
    <*> peekByteOff p 8
  poke p (NSSize {..}) = do
    pokeByteOff p 0 nsSizeWidth
    pokeByteOff p 8 nsSizeHeight

{-# NOINLINE nsSizeStructType #-}
nsSizeStructType :: Ptr CType
nsSizeStructType = unsafePerformIO $ fst <$> newStructCType [ffi_type_double, ffi_type_double]

argNSSize :: NSSize -> Arg
argNSSize = mkStorableArg nsSizeStructType

retNSSize :: RetType NSSize
retNSSize = mkStorableRetType nsSizeStructType

instance ObjCArgument NSSize where
  withObjCArg x k = k (argNSSize x)

instance ObjCReturn NSSize where
  type RawReturn NSSize = NSSize
  objcRetType = retNSSize
  msgSendVariant = MsgSendStret
  fromRetained = pure
  fromOwned = pure

data NSRect = NSRect
  { nsRectOrigin :: !NSPoint
  , nsRectSize :: !NSSize
  } deriving (Eq, Show)

instance Storable NSRect where
  sizeOf    _ = 32
  alignment _ = 8
  peek p = NSRect <$> peekByteOff p 0
    <*> peekByteOff p 16
  poke p (NSRect {..}) = do
    pokeByteOff p 0 nsRectOrigin
    pokeByteOff p 16 nsRectSize

{-# NOINLINE nsRectStructType #-}
nsRectStructType :: Ptr CType
nsRectStructType = unsafePerformIO $ fst <$> newStructCType [nsPointStructType, nsSizeStructType]

argNSRect :: NSRect -> Arg
argNSRect = mkStorableArg nsRectStructType

retNSRect :: RetType NSRect
retNSRect = mkStorableRetType nsRectStructType

instance ObjCArgument NSRect where
  withObjCArg x k = k (argNSRect x)

instance ObjCReturn NSRect where
  type RawReturn NSRect = NSRect
  objcRetType = retNSRect
  msgSendVariant = MsgSendStret
  fromRetained = pure
  fromOwned = pure
