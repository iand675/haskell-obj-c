{-# LANGUAGE TypeApplications #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE FlexibleContexts #-}

-- | CLSActivity represents user generated activity data for a given context.
--
-- CLSActivity has three major components.
--
-- (1) Progress, used to measure the amount of activity a user generates as a percentage.             (2) Duration, used to measure the length of time a user spent on this activity. Use @-start@ and @-stop@ methods.             (3) Activity Items, used to gather information about the activity generated by a user.
--
-- Generated bindings for @CLSActivity@.
module ObjC.ClassKit.CLSActivity
  ( CLSActivity
  , IsCLSActivity(..)
  , addProgressRangeFromStart_toEnd
  , addAdditionalActivityItem
  , start
  , stop
  , removeAllActivityItems
  , progress
  , setProgress
  , duration
  , primaryActivityItem
  , setPrimaryActivityItem
  , additionalActivityItems
  , started
  , addProgressRangeFromStart_toEndSelector
  , addAdditionalActivityItemSelector
  , startSelector
  , stopSelector
  , removeAllActivityItemsSelector
  , progressSelector
  , setProgressSelector
  , durationSelector
  , primaryActivityItemSelector
  , setPrimaryActivityItemSelector
  , additionalActivityItemsSelector
  , startedSelector


  ) where

import Foreign.Ptr (Ptr, nullPtr, castPtr)
import Foreign.LibFFI
import Foreign.C.Types
import Data.Int (Int8, Int16)
import Data.Word (Word16)
import Data.Coerce (coerce)

import ObjC.Runtime.Types
import ObjC.Runtime.MsgSend (sendMsg, sendClassMsg)
import ObjC.Runtime.Selector (mkSelector)
import ObjC.Runtime.Class (getRequiredClass)

import ObjC.ClassKit.Internal.Classes
import ObjC.Foundation.Internal.Classes

-- | Adds progress to this activity.
--
-- The progress should be a decimal representation of the start and ending percentage [0.0, 1.0].
--
-- @start@ — Starting percentage.
--
-- @end@ — Ending percentage.
--
-- ObjC selector: @- addProgressRangeFromStart:toEnd:@
addProgressRangeFromStart_toEnd :: IsCLSActivity clsActivity => clsActivity -> CDouble -> CDouble -> IO ()
addProgressRangeFromStart_toEnd clsActivity  start end =
  sendMsg clsActivity (mkSelector "addProgressRangeFromStart:toEnd:") retVoid [argCDouble (fromIntegral start), argCDouble (fromIntegral end)]

-- | Add an activity item to this CLSActivity.
--
-- ObjC selector: @- addAdditionalActivityItem:@
addAdditionalActivityItem :: (IsCLSActivity clsActivity, IsCLSActivityItem activityItem) => clsActivity -> activityItem -> IO ()
addAdditionalActivityItem clsActivity  activityItem =
withObjCPtr activityItem $ \raw_activityItem ->
    sendMsg clsActivity (mkSelector "addAdditionalActivityItem:") retVoid [argPtr (castPtr raw_activityItem :: Ptr ())]

-- | Start Activity.
--
-- Starts the activity (or resumes if previously stopped).
--
-- ObjC selector: @- start@
start :: IsCLSActivity clsActivity => clsActivity -> IO ()
start clsActivity  =
  sendMsg clsActivity (mkSelector "start") retVoid []

-- | Stop Activity.
--
-- Stops or pauses the activity and ends the time being tracked on it.
--
-- ObjC selector: @- stop@
stop :: IsCLSActivity clsActivity => clsActivity -> IO ()
stop clsActivity  =
  sendMsg clsActivity (mkSelector "stop") retVoid []

-- | Deletes all activity items.
--
-- Convenience method to delete all activity items associated with the current activity.
--
-- ObjC selector: @- removeAllActivityItems@
removeAllActivityItems :: IsCLSActivity clsActivity => clsActivity -> IO ()
removeAllActivityItems clsActivity  =
  sendMsg clsActivity (mkSelector "removeAllActivityItems") retVoid []

-- | Current progress as a decimal representation of a percentage.
--
-- Should be [0.0, 1.0].
--
-- ObjC selector: @- progress@
progress :: IsCLSActivity clsActivity => clsActivity -> IO CDouble
progress clsActivity  =
  sendMsg clsActivity (mkSelector "progress") retCDouble []

-- | Current progress as a decimal representation of a percentage.
--
-- Should be [0.0, 1.0].
--
-- ObjC selector: @- setProgress:@
setProgress :: IsCLSActivity clsActivity => clsActivity -> CDouble -> IO ()
setProgress clsActivity  value =
  sendMsg clsActivity (mkSelector "setProgress:") retVoid [argCDouble (fromIntegral value)]

-- | Returns the total time tracked in this activity (excluding any previous activities).
--
-- The time between calling @-start@ and @-stop.@
--
-- ObjC selector: @- duration@
duration :: IsCLSActivity clsActivity => clsActivity -> IO CDouble
duration clsActivity  =
  sendMsg clsActivity (mkSelector "duration") retCDouble []

-- | The primary activityItem to be reported on.
--
-- This can be nil indicating @progress@ property is the primary data instead of any activityItems.
--
-- ObjC selector: @- primaryActivityItem@
primaryActivityItem :: IsCLSActivity clsActivity => clsActivity -> IO (Id CLSActivityItem)
primaryActivityItem clsActivity  =
  sendMsg clsActivity (mkSelector "primaryActivityItem") (retPtr retVoid) [] >>= retainedObject . castPtr

-- | The primary activityItem to be reported on.
--
-- This can be nil indicating @progress@ property is the primary data instead of any activityItems.
--
-- ObjC selector: @- setPrimaryActivityItem:@
setPrimaryActivityItem :: (IsCLSActivity clsActivity, IsCLSActivityItem value) => clsActivity -> value -> IO ()
setPrimaryActivityItem clsActivity  value =
withObjCPtr value $ \raw_value ->
    sendMsg clsActivity (mkSelector "setPrimaryActivityItem:") retVoid [argPtr (castPtr raw_value :: Ptr ())]

-- | Array of all additional activity items on this CLSActivity.
--
-- ObjC selector: @- additionalActivityItems@
additionalActivityItems :: IsCLSActivity clsActivity => clsActivity -> IO (Id NSArray)
additionalActivityItems clsActivity  =
  sendMsg clsActivity (mkSelector "additionalActivityItems") (retPtr retVoid) [] >>= retainedObject . castPtr

-- | Returns whether this Activity has been started or not.
--
-- ObjC selector: @- started@
started :: IsCLSActivity clsActivity => clsActivity -> IO Bool
started clsActivity  =
  fmap ((/= 0) :: CULong -> Bool) $ sendMsg clsActivity (mkSelector "started") retCULong []

-- ---------------------------------------------------------------------------
-- Selectors
-- ---------------------------------------------------------------------------

-- | @Selector@ for @addProgressRangeFromStart:toEnd:@
addProgressRangeFromStart_toEndSelector :: Selector
addProgressRangeFromStart_toEndSelector = mkSelector "addProgressRangeFromStart:toEnd:"

-- | @Selector@ for @addAdditionalActivityItem:@
addAdditionalActivityItemSelector :: Selector
addAdditionalActivityItemSelector = mkSelector "addAdditionalActivityItem:"

-- | @Selector@ for @start@
startSelector :: Selector
startSelector = mkSelector "start"

-- | @Selector@ for @stop@
stopSelector :: Selector
stopSelector = mkSelector "stop"

-- | @Selector@ for @removeAllActivityItems@
removeAllActivityItemsSelector :: Selector
removeAllActivityItemsSelector = mkSelector "removeAllActivityItems"

-- | @Selector@ for @progress@
progressSelector :: Selector
progressSelector = mkSelector "progress"

-- | @Selector@ for @setProgress:@
setProgressSelector :: Selector
setProgressSelector = mkSelector "setProgress:"

-- | @Selector@ for @duration@
durationSelector :: Selector
durationSelector = mkSelector "duration"

-- | @Selector@ for @primaryActivityItem@
primaryActivityItemSelector :: Selector
primaryActivityItemSelector = mkSelector "primaryActivityItem"

-- | @Selector@ for @setPrimaryActivityItem:@
setPrimaryActivityItemSelector :: Selector
setPrimaryActivityItemSelector = mkSelector "setPrimaryActivityItem:"

-- | @Selector@ for @additionalActivityItems@
additionalActivityItemsSelector :: Selector
additionalActivityItemsSelector = mkSelector "additionalActivityItems"

-- | @Selector@ for @started@
startedSelector :: Selector
startedSelector = mkSelector "started"

