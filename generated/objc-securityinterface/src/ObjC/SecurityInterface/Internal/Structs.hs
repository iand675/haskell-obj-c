{-# LANGUAGE RecordWildCards #-}

-- | Struct types for this framework.
--
-- Generated by objc-codegen. Do not edit.
module ObjC.SecurityInterface.Internal.Structs where

import Foreign.Ptr (Ptr, FunPtr)
import Foreign.Storable (Storable(..))
import Foreign.C.Types
import Foreign.LibFFI.Base (Arg, RetType, mkStorableArg, mkStorableRetType, newStructCType)
import Foreign.LibFFI.FFITypes
import Foreign.LibFFI.Internal (CType)
import System.IO.Unsafe (unsafePerformIO)

-- | Callback API provided by the AuthorizationEngine.
--
-- version      Engine callback version.     SetResult    Set a result after a call to AuthorizationSessionInvoke.     RequestInterrupt Request authorization engine to interrupt all mechamisms invoked after this mechamism has called SessionSetResult and then call AuthorizationSessionInvoke again.     DidDeactivate    Respond to the Deactivate request.     GetContextValue  Read value from context.  AuthorizationValue does not own data.     SetContextValue  Write value to context.  AuthorizationValue and data are copied.     GetHintValue     Read value from hints. AuthorizationValue does not own data.     SetHintValue     Write value to hints.  AuthorizationValue and data are copied.     GetArguments     Read arguments passed.  AuthorizationValueVector does not own data.     GetSessionId     Read SessionId.     GetLAContext     Returns LAContext which will have LACredentialCTKPIN credential set if PIN is available otherwise context without credentials is returned. LAContext can be used for operations with Tokens which would normally require PIN. Caller owns returned context and is responsible for release.     GetTokenIdentities   Returns array of identities. Caller owns returned array and is reponsible for release.     GetTKTokenWatcher    Returns TKTokenWatcher object. Caller owns returned context and is responsible for release.     RemoveContextValue   Removes value from context.     RemoveHintValue      Removes value from hints.
data AuthorizationCallbacks = AuthorizationCallbacks
  { authorizationCallbacksVersion :: !CUInt
  , authorizationCallbacksSetResult :: !(Ptr ())
  , authorizationCallbacksRequestInterrupt :: !(Ptr ())
  , authorizationCallbacksDidDeactivate :: !(Ptr ())
  , authorizationCallbacksGetContextValue :: !(Ptr ())
  , authorizationCallbacksSetContextValue :: !(Ptr ())
  , authorizationCallbacksGetHintValue :: !(Ptr ())
  , authorizationCallbacksSetHintValue :: !(Ptr ())
  , authorizationCallbacksGetArguments :: !(Ptr ())
  , authorizationCallbacksGetSessionId :: !(Ptr ())
  , authorizationCallbacksGetImmutableHintValue :: !(Ptr ())
  , authorizationCallbacksGetLAContext :: !(Ptr ())
  , authorizationCallbacksGetTokenIdentities :: !(Ptr ())
  , authorizationCallbacksGetTKTokenWatcher :: !(Ptr ())
  , authorizationCallbacksRemoveHintValue :: !(Ptr ())
  , authorizationCallbacksRemoveContextValue :: !(Ptr ())
  } deriving (Eq, Show)

instance Storable AuthorizationCallbacks where
  sizeOf    _ = 128
  alignment _ = 8
  peek p = AuthorizationCallbacks <$> peekByteOff p 0
    <*> peekByteOff p 8
    <*> peekByteOff p 16
    <*> peekByteOff p 24
    <*> peekByteOff p 32
    <*> peekByteOff p 40
    <*> peekByteOff p 48
    <*> peekByteOff p 56
    <*> peekByteOff p 64
    <*> peekByteOff p 72
    <*> peekByteOff p 80
    <*> peekByteOff p 88
    <*> peekByteOff p 96
    <*> peekByteOff p 104
    <*> peekByteOff p 112
    <*> peekByteOff p 120
  poke p (AuthorizationCallbacks {..}) = do
    pokeByteOff p 0 authorizationCallbacksVersion
    pokeByteOff p 8 authorizationCallbacksSetResult
    pokeByteOff p 16 authorizationCallbacksRequestInterrupt
    pokeByteOff p 24 authorizationCallbacksDidDeactivate
    pokeByteOff p 32 authorizationCallbacksGetContextValue
    pokeByteOff p 40 authorizationCallbacksSetContextValue
    pokeByteOff p 48 authorizationCallbacksGetHintValue
    pokeByteOff p 56 authorizationCallbacksSetHintValue
    pokeByteOff p 64 authorizationCallbacksGetArguments
    pokeByteOff p 72 authorizationCallbacksGetSessionId
    pokeByteOff p 80 authorizationCallbacksGetImmutableHintValue
    pokeByteOff p 88 authorizationCallbacksGetLAContext
    pokeByteOff p 96 authorizationCallbacksGetTokenIdentities
    pokeByteOff p 104 authorizationCallbacksGetTKTokenWatcher
    pokeByteOff p 112 authorizationCallbacksRemoveHintValue
    pokeByteOff p 120 authorizationCallbacksRemoveContextValue

{-# NOINLINE authorizationCallbacksStructType #-}
authorizationCallbacksStructType :: Ptr CType
authorizationCallbacksStructType = unsafePerformIO $ fst <$> newStructCType [ffi_type_uint, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer]

argAuthorizationCallbacks :: AuthorizationCallbacks -> Arg
argAuthorizationCallbacks = mkStorableArg authorizationCallbacksStructType

retAuthorizationCallbacks :: RetType AuthorizationCallbacks
retAuthorizationCallbacks = mkStorableRetType authorizationCallbacksStructType

-- | Interface that must be implemented by each plugin.
--
-- version  Must be set to kAuthorizationPluginInterfaceVersion     PluginDestroy    Plugin should clean up and release any resources it is holding.     MechanismCreate  The plugin should create a mechanism named mechanismId.  The mechanism needs to use the AuthorizationEngineRef for the callbacks and pass back a   AuthorizationMechanismRef for itself.  MechanismDestroy will be called when it is no longer needed.     MechanismInvoke  Invoke an instance of a mechanism.  It should call SetResult during or after returning from this function.     MechanismDeactivate  Mechanism should respond with a DidDeactivate as soon as possible     MechanismDestroy Mechanism should clean up and release any resources it is holding
data AuthorizationPluginInterface = AuthorizationPluginInterface
  { authorizationPluginInterfaceVersion :: !CUInt
  , authorizationPluginInterfacePluginDestroy :: !(Ptr ())
  , authorizationPluginInterfaceMechanismCreate :: !(Ptr ())
  , authorizationPluginInterfaceMechanismInvoke :: !(Ptr ())
  , authorizationPluginInterfaceMechanismDeactivate :: !(Ptr ())
  , authorizationPluginInterfaceMechanismDestroy :: !(Ptr ())
  } deriving (Eq, Show)

instance Storable AuthorizationPluginInterface where
  sizeOf    _ = 48
  alignment _ = 8
  peek p = AuthorizationPluginInterface <$> peekByteOff p 0
    <*> peekByteOff p 8
    <*> peekByteOff p 16
    <*> peekByteOff p 24
    <*> peekByteOff p 32
    <*> peekByteOff p 40
  poke p (AuthorizationPluginInterface {..}) = do
    pokeByteOff p 0 authorizationPluginInterfaceVersion
    pokeByteOff p 8 authorizationPluginInterfacePluginDestroy
    pokeByteOff p 16 authorizationPluginInterfaceMechanismCreate
    pokeByteOff p 24 authorizationPluginInterfaceMechanismInvoke
    pokeByteOff p 32 authorizationPluginInterfaceMechanismDeactivate
    pokeByteOff p 40 authorizationPluginInterfaceMechanismDestroy

{-# NOINLINE authorizationPluginInterfaceStructType #-}
authorizationPluginInterfaceStructType :: Ptr CType
authorizationPluginInterfaceStructType = unsafePerformIO $ fst <$> newStructCType [ffi_type_uint, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer, ffi_type_pointer]

argAuthorizationPluginInterface :: AuthorizationPluginInterface -> Arg
argAuthorizationPluginInterface = mkStorableArg authorizationPluginInterfaceStructType

retAuthorizationPluginInterface :: RetType AuthorizationPluginInterface
retAuthorizationPluginInterface = mkStorableRetType authorizationPluginInterfaceStructType

-- | AuthorizationValue
--
-- Auxiliary data is passed between the engine and the mechanism as AuthorizationValues
data AuthorizationValue = AuthorizationValue
  { authorizationValueLength :: !CULong
  , authorizationValueData :: !(Ptr ())
  } deriving (Eq, Show)

instance Storable AuthorizationValue where
  sizeOf    _ = 16
  alignment _ = 8
  peek p = AuthorizationValue <$> peekByteOff p 0
    <*> peekByteOff p 8
  poke p (AuthorizationValue {..}) = do
    pokeByteOff p 0 authorizationValueLength
    pokeByteOff p 8 authorizationValueData

{-# NOINLINE authorizationValueStructType #-}
authorizationValueStructType :: Ptr CType
authorizationValueStructType = unsafePerformIO $ fst <$> newStructCType [ffi_type_ulong, ffi_type_pointer]

argAuthorizationValue :: AuthorizationValue -> Arg
argAuthorizationValue = mkStorableArg authorizationValueStructType

retAuthorizationValue :: RetType AuthorizationValue
retAuthorizationValue = mkStorableRetType authorizationValueStructType
